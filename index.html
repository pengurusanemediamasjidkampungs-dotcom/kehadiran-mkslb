<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kiosk Kehadiran MKSLB</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0a0a0a">
    <style>
        :root { --primary: #D4AF37; --bg: #0a0a0a; --card: #1c1c1e; --text-gold: #FFD700; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; color: white; }
        .header { text-align: center; margin-bottom: 10px; width: 100%; }
        .header img { width: 80px; margin-bottom: 10px; }
        .header h1 { font-size: 0.9rem; color: var(--text-gold); letter-spacing: 2px; text-transform: uppercase; margin: 0; }
        #clock { font-size: 3.2rem; font-weight: 800; color: var(--text-gold); margin: 5px 0; text-shadow: 0 0 15px rgba(255, 215, 0, 0.4); }
        .date-display { font-size: 0.9rem; line-height: 1.4; text-align: center; margin-bottom: 15px; color: #ddd; }
        
        #solat-module { width: 100%; max-width: 500px; margin-bottom: 20px; background: rgba(212, 175, 55, 0.1); border: 1px solid var(--primary); border-radius: 20px; padding: 15px; text-align: center; }
        #next-solat-label { font-size: 0.7rem; color: var(--text-gold); letter-spacing: 1.5px; font-weight: 600; }
        #countdown-display { font-size: 2.8rem; font-weight: 800; color: #fff; margin: 5px 0; font-variant-numeric: tabular-nums; }
        
        .section-title { width: 100%; max-width: 500px; font-size: 0.75rem; font-weight: bold; color: var(--primary); margin: 15px 0 10px; text-transform: uppercase; border-left: 3px solid var(--primary); padding-left: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; max-width: 500px; }
        .btn { background: var(--card); border: 1px solid rgba(212, 175, 55, 0.2); padding: 18px 10px; border-radius: 15px; text-decoration: none; color: white; font-weight: 700; text-align: center; display: flex; flex-direction: column; align-items: center; transition: 0.2s; }
        .btn:active { transform: scale(0.95); background: #2c2c2e; }
        .btn span { font-size: 0.6rem; color: var(--text-gold); margin-bottom: 4px; background: rgba(212, 175, 55, 0.1); padding: 2px 8px; border-radius: 10px; }
        
        .footer { margin-top: 30px; font-size: 0.6rem; color: var(--primary); opacity: 0.6; }
    </style>
</head>
<body>

    <div class="header">
        <img src="logo.png" alt="Logo">
        <h1>SISTEM KEHADIRAN MKSLB</h1>
        <div id="clock">00:00:00 --</div>
        <div id="date" class="date-display">...</div>
    </div>

    <div id="solat-module">
        <div id="next-solat-label">MENYEMAK TAKWIM...</div>
        <div id="countdown-display">00:00:00</div>
    </div>

    <div class="section-title">KUMPULAN PENTADBIR</div>
    <div class="grid">
        <a href="nazir.html" class="btn"><span>NAZIR</span>TN. HJ FAUZI DIN</a>
    </div>

    <div class="section-title">KUMPULAN IMAM</div>
    <div class="grid">
        <a href="Imam1.html" class="btn"><span>IMAM 1</span>AZAHARI</a>
        <a href="Imam2.html" class="btn"><span>IMAM 2</span>NAUDI HAQQI</a>
        <a href="Imam3.html" class="btn"><span>IMAM 3</span>MUHAMMAD AIMAN</a>
        <a href="Imam4.html" class="btn"><span>IMAM 4</span>FAIZ MUFASSIR</a>
    </div>

    <div class="section-title">KUMPULAN BILAL</div>
    <div class="grid">
        <a href="bilal1.html" class="btn"><span>BILAL 1</span>NORFAIZAL</a>
        <a href="bilal2.html" class="btn"><span>BILAL 2</span>SYAMIM FIKRI</a>
        <a href="bilal3.html" class="btn"><span>BILAL 3</span>FAUZI ROSLAN</a>
        <a href="bilal4.html" class="btn"><span>BILAL 4</span>HJ. MAKSOM</a>
    </div>

    <div class="footer">Â© 2026 E-MEDIA MKSLB v3.0</div>

    <script>
        // API URL (Pastikan URL ini betul dari GAS Waktu Solat anda)
        const API_URL = "https://script.google.com/macros/s/AKfycbwsBivLbn5sD3joTBqhesqgaXLgdWBvwJ2JhO8yFZmewoR1VlWVcWZ3tunWYs-jANItqw/exec";

        function updateTime() {
            const now = new Date();
            let h = now.getHours();
            const m = String(now.getMinutes()).padStart(2, '0');
            const s = String(now.getSeconds()).padStart(2, '0');
            const ampm = h >= 12 ? 'PM' : 'AM';
            h = h % 12 || 12;
            document.getElementById('clock').textContent = `${String(h).padStart(2,'0')}:${m}:${s} ${ampm}`;
            document.getElementById('date').textContent = now.toLocaleDateString('ms-MY', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' }) + " Masihi";
        }

        async function getSolat() {
            try {
                const res = await fetch(API_URL);
                const data = await res.json();
                processSolat(data);
            } catch (e) {
                document.getElementById('next-solat-label').innerText = "RALAT HUBUNGAN API";
            }
        }

        function processSolat(waktu) {
            const susunan = [
                {n: 'Subuh', k: 'subuh', h: 5},
                {n: 'Syuruq', k: 'syuruq', h: 7},
                {n: 'Zohor', k: 'zohor', h: 13},
                {n: 'Asar', k: 'asar', h: 16},
                {n: 'Maghrib', k: 'maghrib', h: 19},
                {n: 'Isyak', k: 'isya', h: 20}
            ];

            const skrg = new Date();
            let target = null;
            let targetNama = "";

            for (let s of susunan) {
                let masaStr = waktu[s.k];
                if (!masaStr) continue;

                let [jam, min] = masaStr.split(':').map(Number);
                // Logik Fix: Jika waktu solat (Zohor-Isyak) < 12, tambah 12 untuk jadi format 24 jam
                if (s.h >= 12 && jam < 12) jam += 12;

                let tSolat = new Date();
                tSolat.setHours(jam, min, 0);

                if (tSolat > skrg) {
                    target = tSolat;
                    targetNama = s.n.toUpperCase();
                    break;
                }
            }

            if (target) {
                setInterval(() => {
                    const beza = target - new Date();
                    if (beza <= 0) { location.reload(); return; }
                    const h = String(Math.floor(beza / 3600000)).padStart(2, '0');
                    const m = String(Math.floor((beza % 3600000) / 60000)).padStart(2, '0');
                    const s = String(Math.floor((beza % 60000) / 1000)).padStart(2, '0');
                    document.getElementById('next-solat-label').innerText = `COUNTDOWN KE WAKTU ${targetNama}`;
                    document.getElementById('countdown-display').innerText = `${h}:${m}:${s}`;
                }, 1000);
            } else {
                document.getElementById('next-solat-label').innerText = "WAKTU ISYAK TELAH MASUK";
                document.getElementById('countdown-display').innerText = "00:00:00";
            }
        }

        setInterval(updateTime, 1000);
        updateTime();
        getSolat();
    </script>
</body>
</html>
